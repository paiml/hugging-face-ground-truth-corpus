"""Inference recipes for HuggingFace models.

This module provides utilities for creating pipelines, batch inference,
device placement, and inference optimizations.

Examples:
    >>> from hf_gtc.inference import get_device, BatchConfig
    >>> device = get_device()
    >>> device in ("cuda", "mps", "cpu")
    True
    >>> config = BatchConfig(batch_size=32)
    >>> config.batch_size
    32
"""

from __future__ import annotations

from hf_gtc.inference.batch import (
    BatchConfig,
    BatchResult,
    BatchStats,
    PaddingStrategy,
    compute_batch_stats,
    compute_num_batches,
    create_batches,
    estimate_memory_per_batch,
    get_optimal_batch_size,
    list_padding_strategies,
    validate_batch_config,
)
from hf_gtc.inference.batching import (
    VALID_BATCHING_STRATEGIES,
    VALID_QUEUE_OVERFLOW_POLICIES,
    VALID_SCHEDULING_POLICIES,
    BatchingStats,
    BatchingStrategy,
    LatencySLO,
    QueueConfig,
    QueueOverflowPolicy,
    SchedulingPolicy,
    calculate_optimal_batch_size,
    calculate_token_budget,
    check_slo_compliance,
    create_batch_config,
    create_batching_stats,
    create_latency_slo,
    create_queue_config,
    estimate_throughput,
    format_batching_stats,
    get_batching_strategy,
    get_queue_overflow_policy,
    get_recommended_batching_config,
    get_scheduling_policy,
    list_batching_strategies,
    list_queue_overflow_policies,
    list_scheduling_policies,
    validate_batching_stats,
    validate_latency_slo,
    validate_queue_config,
)
from hf_gtc.inference.batching import (
    BatchConfig as ContinuousBatchConfig,
)
from hf_gtc.inference.caching import (
    VALID_CACHE_BACKENDS,
    CacheBackend,
    CacheConfig,
    CacheType,
    PrefixConfig,
    SemanticCacheConfig,
    calculate_cache_hit_rate,
    calculate_memory_overhead,
    create_cache_config,
    create_cache_stats,
    create_prefix_config,
    create_semantic_cache_config,
    estimate_latency_savings,
    get_cache_backend,
    get_cache_type,
    list_cache_backends,
    list_cache_types,
    optimize_cache_size,
    validate_cache_config,
    validate_cache_stats,
    validate_prefix_config,
    validate_semantic_cache_config,
)
from hf_gtc.inference.caching import (
    VALID_CACHE_TYPES as VALID_PROMPT_CACHE_TYPES,
)
from hf_gtc.inference.caching import (
    VALID_EVICTION_POLICIES as VALID_CACHING_EVICTION_POLICIES,
)
from hf_gtc.inference.caching import (
    CacheStats as PromptCacheStats,
)
from hf_gtc.inference.caching import (
    EvictionPolicy as CachingEvictionPolicy,
)
from hf_gtc.inference.caching import (
    format_cache_stats as format_prompt_cache_stats,
)
from hf_gtc.inference.caching import (
    get_eviction_policy as get_caching_eviction_policy,
)
from hf_gtc.inference.caching import (
    get_recommended_cache_config as get_recommended_prompt_cache_config,
)
from hf_gtc.inference.caching import (
    list_eviction_policies as list_caching_eviction_policies,
)
from hf_gtc.inference.context import (
    VALID_ATTENTION_PATTERNS,
    VALID_EXTENSION_METHODS,
    VALID_ROPE_SCALING_TYPES,
    AttentionPattern,
    ContextConfig,
    ContextStats,
    ExtensionMethod,
    RoPEConfig,
    RoPEScalingType,
    SlidingWindowConfig,
    calculate_attention_complexity,
    calculate_effective_length,
    create_context_config,
    create_context_stats,
    create_rope_config,
    create_sliding_window_config,
    estimate_memory_scaling,
    format_context_stats,
    get_attention_pattern,
    get_extension_method,
    get_recommended_context_config,
    get_rope_scaling_type,
    list_attention_patterns,
    list_extension_methods,
    list_rope_scaling_types,
    validate_context_config,
    validate_context_stats,
    validate_position_ids,
    validate_rope_config,
    validate_sliding_window_config,
)
from hf_gtc.inference.device import (
    clear_gpu_memory,
    get_device,
    get_device_map,
    get_gpu_memory_info,
)
from hf_gtc.inference.embeddings import (
    VALID_DISTANCE_METRICS,
    VALID_EMBEDDING_NORMALIZATIONS,
    VALID_POOLING_MODES,
    VALID_POOLING_STRATEGIES,
    VALID_SIMILARITY_METRICS,
    EmbeddingConfig,
    EmbeddingNormalization,
    EmbeddingResult,
    EmbeddingStats,
    PoolingConfig,
    PoolingMode,
    PoolingStrategy,
    SimilarityMetric,
    SimilarityResult,
    calculate_similarity,
    chunk_text,
    compute_pooled_embedding,
    cosine_similarity,
    create_embedding_config,
    create_embedding_result,
    create_embedding_stats,
    create_pooling_config,
    dot_product_similarity,
    estimate_embedding_memory,
    estimate_embedding_quality,
    euclidean_distance,
    format_embedding_stats,
    get_embedding_normalization,
    get_pooling_strategy,
    get_recommended_embedding_config,
    get_recommended_model,
    get_similarity_metric,
    list_distance_metrics,
    list_embedding_normalizations,
    list_pooling_modes,
    list_pooling_strategies,
    list_similarity_metrics,
    normalize_embeddings,
    normalize_vector,
    validate_embedding_config,
    validate_embedding_result,
    validate_embedding_stats,
    validate_pooling_config,
)
from hf_gtc.inference.kv_cache import (
    VALID_CACHE_COMPRESSIONS,
    VALID_EVICTION_POLICIES,
    VALID_PAGED_ATTENTION_MODES,
    CacheCompression,
    CacheEntry,
    CacheStats,
    EvictionPolicy,
    KVCacheManagementConfig,
    PagedAttentionConfig,
    PagedAttentionMode,
    calculate_cache_memory,
    calculate_compression_savings,
    calculate_optimal_page_size,
    create_cache_entry,
    create_kv_cache_management_config,
    create_paged_attention_config,
    estimate_max_sequences,
    format_cache_stats,
    get_cache_compression,
    get_eviction_policy,
    get_paged_attention_mode,
    get_recommended_cache_config,
    list_cache_compressions,
    list_eviction_policies,
    list_paged_attention_modes,
    validate_cache_entry,
    validate_kv_cache_management_config,
    validate_paged_attention_config,
)
from hf_gtc.inference.optimization import (
    VALID_ATTENTION_IMPLS,
    VALID_CACHE_TYPES,
    VALID_KV_QUANT_TYPES,
    AttentionImplementation,
    ContinuousBatchingConfig,
    FlashAttentionConfig,
    KVCacheConfig,
    KVCacheType,
    QuantizedKVConfig,
    SpeculativeDecodingConfig,
    calculate_speculative_speedup,
    create_continuous_batching_config,
    create_flash_attention_config,
    create_kv_cache_config,
    create_quantized_kv_config,
    create_speculative_decoding_config,
    estimate_kv_cache_memory,
    get_recommended_attention,
    list_attention_implementations,
    list_kv_cache_types,
    validate_kv_cache_config,
    validate_speculative_config,
)
from hf_gtc.inference.pipelines import create_pipeline, list_supported_tasks
from hf_gtc.inference.quantization import (
    VALID_CALIBRATION_STRATEGIES,
    VALID_QUANTIZATION_GRANULARITIES,
    VALID_QUANTIZATION_METHODS,
    AWQConfig,
    CalibrationStrategy,
    GGUFConfig,
    GPTQConfig,
    QuantizationConfig,
    QuantizationGranularity,
    QuantizationMethod,
    QuantizationStats,
    calculate_bits_per_weight,
    calculate_quantization_error,
    create_awq_config,
    create_gguf_config,
    create_gptq_config,
    create_quantization_config,
    create_quantization_stats,
    estimate_memory_savings,
    format_quantization_stats,
    get_calibration_strategy,
    get_quantization_granularity,
    get_quantization_method,
    get_recommended_quantization_config,
    list_calibration_strategies,
    list_quantization_granularities,
    list_quantization_methods,
    select_calibration_data,
    validate_awq_config,
    validate_gguf_config,
    validate_gptq_config,
    validate_quantization_config,
    validate_quantization_stats,
)
from hf_gtc.inference.speculative import (
    VALID_ACCEPTANCE_CRITERIA,
    VALID_DRAFT_MODEL_TYPES,
    VALID_VERIFICATION_STRATEGIES,
    AcceptanceCriteria,
    DraftModelConfig,
    DraftModelType,
    SpeculativeConfig,
    SpeculativeStats,
    VerificationConfig,
    VerificationStrategy,
    calculate_expected_speedup,
    calculate_speculation_efficiency,
    create_draft_model_config,
    create_speculative_config,
    create_verification_config,
    estimate_acceptance_rate,
    format_speculative_stats,
    get_acceptance_criteria,
    get_draft_model_type,
    get_recommended_speculative_config,
    get_verification_strategy,
    list_acceptance_criteria,
    list_draft_model_types,
    list_verification_strategies,
    validate_draft_model_config,
    validate_verification_config,
)
from hf_gtc.inference.speculative import (
    validate_speculative_config as validate_speculative_config_full,
)
from hf_gtc.inference.streaming import (
    VALID_CALLBACK_TYPES,
    VALID_OVERFLOW_STRATEGIES,
    VALID_STREAMING_MODES,
    BufferConfig,
    CallbackType,
    ChunkConfig,
    StreamConfig,
    StreamEvent,
    StreamingMode,
    StreamingStats,
    calculate_tokens_per_second,
    create_buffer_config,
    create_chunk_config,
    create_stream_config,
    estimate_stream_duration,
    get_callback_type,
    get_streaming_mode,
    list_callback_types,
    list_streaming_modes,
    validate_chunk_config,
    validate_stream_config,
)

__all__: list[str] = [
    # Frozensets
    "VALID_ACCEPTANCE_CRITERIA",
    "VALID_ATTENTION_IMPLS",
    "VALID_ATTENTION_PATTERNS",
    "VALID_BATCHING_STRATEGIES",
    "VALID_CACHE_BACKENDS",
    "VALID_CACHE_COMPRESSIONS",
    "VALID_CACHE_TYPES",
    "VALID_CACHING_EVICTION_POLICIES",
    "VALID_CALIBRATION_STRATEGIES",
    "VALID_CALLBACK_TYPES",
    "VALID_DISTANCE_METRICS",
    "VALID_DRAFT_MODEL_TYPES",
    "VALID_EMBEDDING_NORMALIZATIONS",
    "VALID_EVICTION_POLICIES",
    "VALID_EXTENSION_METHODS",
    "VALID_KV_QUANT_TYPES",
    "VALID_OVERFLOW_STRATEGIES",
    "VALID_PAGED_ATTENTION_MODES",
    "VALID_POOLING_MODES",
    "VALID_POOLING_STRATEGIES",
    "VALID_PROMPT_CACHE_TYPES",
    "VALID_QUANTIZATION_GRANULARITIES",
    "VALID_QUANTIZATION_METHODS",
    "VALID_QUEUE_OVERFLOW_POLICIES",
    "VALID_ROPE_SCALING_TYPES",
    "VALID_SCHEDULING_POLICIES",
    "VALID_SIMILARITY_METRICS",
    "VALID_STREAMING_MODES",
    "VALID_VERIFICATION_STRATEGIES",
    # Dataclasses
    "AWQConfig",
    # Enums
    "AcceptanceCriteria",
    "AttentionImplementation",
    "AttentionPattern",
    "BatchConfig",
    "BatchResult",
    "BatchStats",
    "BatchingStats",
    "BatchingStrategy",
    "BufferConfig",
    "CacheBackend",
    "CacheCompression",
    "CacheConfig",
    "CacheEntry",
    "CacheStats",
    "CacheType",
    "CachingEvictionPolicy",
    "CalibrationStrategy",
    "CallbackType",
    "ChunkConfig",
    "ContextConfig",
    "ContextStats",
    "ContinuousBatchConfig",
    "ContinuousBatchingConfig",
    "DraftModelConfig",
    "DraftModelType",
    "EmbeddingConfig",
    "EmbeddingNormalization",
    "EmbeddingResult",
    "EmbeddingStats",
    "EvictionPolicy",
    "ExtensionMethod",
    "FlashAttentionConfig",
    "GGUFConfig",
    "GPTQConfig",
    "KVCacheConfig",
    "KVCacheManagementConfig",
    "KVCacheType",
    "LatencySLO",
    "PaddingStrategy",
    "PagedAttentionConfig",
    "PagedAttentionMode",
    "PoolingConfig",
    "PoolingMode",
    "PoolingStrategy",
    "PrefixConfig",
    "PromptCacheStats",
    "QuantizationConfig",
    "QuantizationGranularity",
    "QuantizationMethod",
    "QuantizationStats",
    "QuantizedKVConfig",
    "QueueConfig",
    "QueueOverflowPolicy",
    "RoPEConfig",
    "RoPEScalingType",
    "SchedulingPolicy",
    "SemanticCacheConfig",
    "SimilarityMetric",
    "SimilarityResult",
    "SlidingWindowConfig",
    "SpeculativeConfig",
    "SpeculativeDecodingConfig",
    "SpeculativeStats",
    "StreamConfig",
    "StreamEvent",
    "StreamingMode",
    "StreamingStats",
    "VerificationConfig",
    "VerificationStrategy",
    # Functions
    "calculate_attention_complexity",
    "calculate_bits_per_weight",
    "calculate_cache_hit_rate",
    "calculate_cache_memory",
    "calculate_compression_savings",
    "calculate_effective_length",
    "calculate_expected_speedup",
    "calculate_memory_overhead",
    "calculate_optimal_batch_size",
    "calculate_optimal_page_size",
    "calculate_quantization_error",
    "calculate_similarity",
    "calculate_speculation_efficiency",
    "calculate_speculative_speedup",
    "calculate_token_budget",
    "calculate_tokens_per_second",
    "check_slo_compliance",
    "chunk_text",
    "clear_gpu_memory",
    "compute_batch_stats",
    "compute_num_batches",
    "compute_pooled_embedding",
    "cosine_similarity",
    "create_awq_config",
    "create_batch_config",
    "create_batches",
    "create_batching_stats",
    "create_buffer_config",
    "create_cache_config",
    "create_cache_entry",
    "create_cache_stats",
    "create_chunk_config",
    "create_context_config",
    "create_context_stats",
    "create_continuous_batching_config",
    "create_draft_model_config",
    "create_embedding_config",
    "create_embedding_result",
    "create_embedding_stats",
    "create_flash_attention_config",
    "create_gguf_config",
    "create_gptq_config",
    "create_kv_cache_config",
    "create_kv_cache_management_config",
    "create_latency_slo",
    "create_paged_attention_config",
    "create_pipeline",
    "create_pooling_config",
    "create_prefix_config",
    "create_quantization_config",
    "create_quantization_stats",
    "create_quantized_kv_config",
    "create_queue_config",
    "create_rope_config",
    "create_semantic_cache_config",
    "create_sliding_window_config",
    "create_speculative_config",
    "create_speculative_decoding_config",
    "create_stream_config",
    "create_verification_config",
    "dot_product_similarity",
    "estimate_acceptance_rate",
    "estimate_embedding_memory",
    "estimate_embedding_quality",
    "estimate_kv_cache_memory",
    "estimate_latency_savings",
    "estimate_max_sequences",
    "estimate_memory_per_batch",
    "estimate_memory_savings",
    "estimate_memory_scaling",
    "estimate_stream_duration",
    "estimate_throughput",
    "euclidean_distance",
    "format_batching_stats",
    "format_cache_stats",
    "format_context_stats",
    "format_embedding_stats",
    "format_prompt_cache_stats",
    "format_quantization_stats",
    "format_speculative_stats",
    "get_acceptance_criteria",
    "get_attention_pattern",
    "get_batching_strategy",
    "get_cache_backend",
    "get_cache_compression",
    "get_cache_type",
    "get_caching_eviction_policy",
    "get_calibration_strategy",
    "get_callback_type",
    "get_device",
    "get_device_map",
    "get_draft_model_type",
    "get_embedding_normalization",
    "get_eviction_policy",
    "get_extension_method",
    "get_gpu_memory_info",
    "get_optimal_batch_size",
    "get_paged_attention_mode",
    "get_pooling_strategy",
    "get_quantization_granularity",
    "get_quantization_method",
    "get_queue_overflow_policy",
    "get_recommended_attention",
    "get_recommended_batching_config",
    "get_recommended_cache_config",
    "get_recommended_context_config",
    "get_recommended_embedding_config",
    "get_recommended_model",
    "get_recommended_prompt_cache_config",
    "get_recommended_quantization_config",
    "get_recommended_speculative_config",
    "get_rope_scaling_type",
    "get_scheduling_policy",
    "get_similarity_metric",
    "get_streaming_mode",
    "get_verification_strategy",
    "list_acceptance_criteria",
    "list_attention_implementations",
    "list_attention_patterns",
    "list_batching_strategies",
    "list_cache_backends",
    "list_cache_compressions",
    "list_cache_types",
    "list_caching_eviction_policies",
    "list_calibration_strategies",
    "list_callback_types",
    "list_distance_metrics",
    "list_draft_model_types",
    "list_embedding_normalizations",
    "list_eviction_policies",
    "list_extension_methods",
    "list_kv_cache_types",
    "list_padding_strategies",
    "list_paged_attention_modes",
    "list_pooling_modes",
    "list_pooling_strategies",
    "list_quantization_granularities",
    "list_quantization_methods",
    "list_queue_overflow_policies",
    "list_rope_scaling_types",
    "list_scheduling_policies",
    "list_similarity_metrics",
    "list_streaming_modes",
    "list_supported_tasks",
    "list_verification_strategies",
    "normalize_embeddings",
    "normalize_vector",
    "optimize_cache_size",
    "select_calibration_data",
    "validate_awq_config",
    "validate_batch_config",
    "validate_batching_stats",
    "validate_cache_config",
    "validate_cache_entry",
    "validate_cache_stats",
    "validate_chunk_config",
    "validate_context_config",
    "validate_context_stats",
    "validate_draft_model_config",
    "validate_embedding_config",
    "validate_embedding_result",
    "validate_embedding_stats",
    "validate_gguf_config",
    "validate_gptq_config",
    "validate_kv_cache_config",
    "validate_kv_cache_management_config",
    "validate_latency_slo",
    "validate_paged_attention_config",
    "validate_pooling_config",
    "validate_position_ids",
    "validate_prefix_config",
    "validate_quantization_config",
    "validate_quantization_stats",
    "validate_queue_config",
    "validate_rope_config",
    "validate_semantic_cache_config",
    "validate_sliding_window_config",
    "validate_speculative_config",
    "validate_speculative_config_full",
    "validate_stream_config",
    "validate_verification_config",
]
